{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hoja de Vida Profesional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            color: #2c3e50;
            padding: 20px;
            line-height: 1.6;
        }
        
        .cv-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #f5f5f5;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-weight: bold;
        }
        
        .perfil {
            text-align: center;
        }
        
        .perfil h2 {
            color: #2c3e50;
            font-size: 24px;
            margin: 15px 0 20px 0;
            font-weight: bold;
        }
        
        .foto-perfil {
            width: 130px;
            height: 130px;
            border-radius: 65px;
            border: 4px solid #3498db;
            margin: 0 auto 15px;
            display: block;
        }
        
        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
            text-align: center;
            display: inline-block;
        }
        
        .info-list li {
            font-size: 13px;
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .info-list strong {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .item {
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .item h4 {
            color: #2c3e50;
            font-size: 15px;
            margin: 0 0 5px 0;
            font-weight: bold;
        }
        
        .item span {
            font-size: 12px;
            color: #777;
            display: block;
            margin-bottom: 8px;
        }
        
        .item p {
            font-size: 13px;
            color: #555;
            margin: 8px 0;
            line-height: 1.5;
        }
        
        .item strong {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .item a {
            font-size: 12px;
            color: #3498db;
            text-decoration: underline;
        }
        
        /* Estilos para certificados en pÃ¡gina aparte */
        .certificado-page {
            page-break-before: always;
            width: 100%;
            padding: 40px;
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        
        .certificado-container {
            text-align: center;
            width: 100%;
        }
        
        .certificado-imagen {
            width: 100%;
            max-width: 900px;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            margin: 0 auto;
        }
        
        .certificado-titulo {
            font-size: 20px;
            color: #2c3e50;
            margin-top: 20px;
            font-weight: bold;
        }
        
        .certificado-entidad {
            font-size: 14px;
            color: #777;
            margin-top: 8px;
        }
    </style>
</head>
<body>

<div class="cv-container">
<!-- DATOS PERSONALES -->
<div class="card perfil">
    {% if datos.foto %}
        <img src="{{ datos.foto.url }}" class="foto-perfil" style="width: 130px; height: 130px;">
    {% else %}
        <div class="foto-perfil" style="background-color: #ddd; display: flex; align-items: center; justify-content: center; color: #999; width: 130px; height: 130px;">
            Sin foto
        </div>
    {% endif %}

    <h2>{{ datos.nombres }} {{ datos.apellidos }}</h2>

    <ul class="info-list">
        {% if datos.numerocedula %}
            <li><strong>CÃ©dula:</strong> {{ datos.numerocedula }}</li>
        {% endif %}
        {% if datos.nacionalidad %}
            <li><strong>Nacionalidad:</strong> {{ datos.nacionalidad }}</li>
        {% endif %}
        {% if datos.lugarnacimiento %}
            <li><strong>Lugar de nacimiento:</strong> {{ datos.lugarnacimiento }}</li>
        {% endif %}
        {% if datos.fechanacimiento %}
            <li><strong>Fecha de nacimiento:</strong> {{ datos.fechanacimiento|date:"d/m/Y" }}</li>
        {% endif %}
        {% if datos.sexo %}
            <li><strong>Sexo:</strong> {{ datos.get_sexo_display }}</li>
        {% endif %}
        {% if datos.estadocivil %}
            <li><strong>Estado civil:</strong> {{ datos.estadocivil }}</li>
        {% endif %}
        {% if datos.licenciaconducir %}
            <li><strong>Licencia de conducir:</strong> {{ datos.licenciaconducir }}</li>
        {% endif %}
        {% if datos.telefonoconvencional %}
            <li><strong>TelÃ©fono convencional:</strong> {{ datos.telefonoconvencional }}</li>
        {% endif %}
        {% if datos.telefonofijo %}
            <li><strong>TelÃ©fono fijo:</strong> {{ datos.telefonofijo }}</li>
        {% endif %}
        {% if datos.direcciontrabajo %}
            <li><strong>DirecciÃ³n de trabajo:</strong> {{ datos.direcciontrabajo }}</li>
        {% endif %}
        {% if datos.direcciondomiciliaria %}
            <li><strong>DirecciÃ³n domiciliaria:</strong> {{ datos.direcciondomiciliaria }}</li>
        {% endif %}
        {% if datos.sitioweb %}
            <li><strong>Sitio web:</strong> {{ datos.sitioweb }}</li>
        {% endif %}
    </ul>
</div>

<!-- EXPERIENCIA LABORAL -->
{% if experiencias and datos.mostrar_experiencia %}
<div class="card">
    <h3>Experiencia Laboral</h3>
    {% for e in experiencias %}
        <div class="item">
            <h4>{{ e.cargo }}</h4>
            <span>{{ e.empresa }} | {{ e.fechainicio }} - {{ e.fechafin|default:"Actual" }}</span>
            <p>{{ e.descripcion }}</p>
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- CURSOS -->
{% if cursos and datos.mostrar_cursos %}
<div class="card">
    <h3>Capacitaciones</h3>
    {% for c in cursos %}
        <div class="item">
            <strong>{{ c.nombrecurso }}</strong> â€“ {{ c.entidadpatrocinadora }}
            {% if c.fechainicio %}
                <br><small>{{ c.fechainicio|date:"d/m/Y" }}
                {% if c.fechafin %}- {{ c.fechafin|date:"d/m/Y" }}{% endif %}</small>
            {% endif %}
            {% if c.descripcion %}
                <p>{{ c.descripcion }}</p>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- RECONOCIMIENTOS -->
{% if reconocimientos and datos.mostrar_reconocimientos %}
<div class="card">
    <h3>Reconocimientos</h3>
    {% for r in reconocimientos %}
        <div class="item">
            <strong>{{ r.tiporeconocimiento }}</strong> â€“ {{ r.entidadpatrocinadora }}
            {% if r.fechareconocimiento %}
                <br><small>{{ r.fechareconocimiento|date:"d/m/Y" }}</small>
            {% endif %}
            {% if r.descripcionreconocimiento %}
                <p>{{ r.descripcionreconocimiento }}</p>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- PRODUCTOS ACADÃ‰MICOS -->
{% if productos_academicos and datos.mostrar_productos_academicos %}
<div class="card">
    <h3>Productos AcadÃ©micos</h3>
    {% for p in productos_academicos %}
        <div class="item">
            <strong>{{ p.nombreproducto }}</strong> â€“ {{ p.tiposproducto }}
            {% if p.fechapublicacion %}
                <br><small>Publicado: {{ p.fechapublicacion|date:"d/m/Y" }}</small>
            {% endif %}
            {% if p.descripcion %}
                <p>{{ p.descripcion }}</p>
            {% endif %}

        </div>
    {% endfor %}
</div>
{% endif %}

<!-- PRODUCTOS LABORALES -->
{% if productos_laborales and datos.mostrar_productos_laborales %}
<div class="card">
    <h3>Productos Laborales</h3>
    {% for pl in productos_laborales %}
        <div class="item">
            <strong>{{ pl.nombreproducto }}</strong>
            {% if pl.descripcion %}
                <p>{{ pl.descripcion }}</p>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- VENTA GARAGE -->
{% if ventas and datos.mostrar_ventas %}
<div class="card">
    <h3>Venta Garage</h3>
    {% for v in ventas %}
        <div class="item">
            {% if v.imagen %}
                <img src="data:image/jpeg;base64,{{ v.imagen_base64 }}" alt="{{ v.nombreproducto }}" class="producto-imagen" style="max-width: 80%; margin: 1rem auto; display: block;">
            {% endif %}
            <h4 style="text-align: center; margin-top: 1rem;">{{ v.nombreproducto }}</h4>
            <div style="text-align: center; margin: 1rem 0;">
                <strong style="font-size: 1.1rem;">Precio:</strong> <span style="font-size: 1.2rem; color: #2c3e50;">${{ v.valordelbien }}</span><br>
                {% if v.estadoproducto == "Bueno" %}
                    <span style="display: inline-block; background: #d4edda; color: #155724; padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.95rem; font-weight: 600; margin-top: 0.8rem;">âœ“ {{ v.estadoproducto }}</span>
                {% elif v.estadoproducto == "Regular" %}
                    <span style="display: inline-block; background: #fff3cd; color: #856404; padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.95rem; font-weight: 600; margin-top: 0.8rem;">âš  {{ v.estadoproducto }}</span>
                {% else %}
                    <span style="display: inline-block; background: #f8d7da; color: #721c24; padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.95rem; font-weight: 600; margin-top: 0.8rem;">{{ v.estadoproducto }}</span>
                {% endif %}
                {% if v.fechapublicacion %}
                    <div class="fecha-publicacion" style="margin-top: 0.8rem;">Publicado: {{ v.fechapublicacion|date:"d/m/Y" }}</div>
                {% endif %}
            </div>
            {% if v.descripcion %}
                <p style="text-align: justify;">{{ v.descripcion }}</p>
            {% endif %}
            {% if v.archivo %}
                <a href="{{ v.archivo.url }}" target="_blank">ðŸ“„ Descargar archivo</a>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- ANEXOS - CERTIFICADOS -->
{% if (cursos and datos.mostrar_cursos) or (reconocimientos and datos.mostrar_reconocimientos) %}
    {# CURSOS #}
    {% if cursos and datos.mostrar_cursos %}
        {% for c in cursos %}
            {% if c.certificado_base64 and c.certificado_mime_type %}
                <div style="page-break-before: always; padding: 20px; text-align: center; display: flex; align-items: center; justify-content: center; min-height: 100vh; flex-direction: column;">
                    <h2 style="color: #2c3e50; margin-bottom: 30px; font-size: 24px;">
                        Certificado de Curso
                    </h2>
                    <img
                        src="data:{{ c.certificado_mime_type }};base64,{{ c.certificado_base64 }}"
                        alt="Certificado {{ c.nombrecurso }}"
                        style="width: 95%; max-width: 100%; height: auto;">
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
    {# RECONOCIMIENTOS #}
    {% if reconocimientos and datos.mostrar_reconocimientos %}
        {% for r in reconocimientos %}
            {% if r.certificado_base64 and r.certificado_mime_type %}
                <div class="certificado-page">
                    <div class="certificado-container">
                        <h2 class="certificado-titulo">
                            Certificado de Reconocimiento
                        </h2>
                        <p class="certificado-entidad">
                            {{ r.entidadpatrocinadora }}
                        </p>
                        <img
                            src="data:{{ r.certificado_mime_type }};base64,{{ r.certificado_base64 }}"
                            alt="Certificado {{ r.tiporeconocimiento }}"
                            class="certificado-imagen">
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endif %}